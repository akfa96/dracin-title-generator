<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Generator Judul Dracin Bilingual</title>
  <style>
    body { font-family: 'Poppins', sans-serif; background: #fafafa; color: #333; padding: 40px; text-align: center; }
    input, textarea, button { margin: 8px; padding: 10px; border-radius: 8px; border: 1px solid #ccc; font-size: 14px; }
    button { background: #e11d48; color: #fff; border: none; cursor: pointer; transition: 0.2s; }
    button:hover { background: #be123c; transform: scale(1.03); }
    textarea { width: 90%; height: 200px; }
    pre { text-align: left; background: #fff; padding: 15px; border-radius: 10px; width: 90%; margin: auto; overflow-x: auto; }
  </style>
</head>
<body>

  <h2>üé¨ Generator Judul Dracin Bilingual</h2>
  <p>Masukkan beberapa keyword dracin (satu per baris):</p>
  <textarea id="keywords" placeholder="Contoh:\nHidden Love\nLegend of the Female General"></textarea><br>

  <p>Masukkan beberapa API Key (satu per baris):</p>
  <textarea id="apiKeys" placeholder="Masukkan minimal 2 API key Gemini di sini..."></textarea><br>

  <button onclick="generateTitles()">üöÄ Generate Judul</button>
  <button id="downloadBtn" style="display:none" onclick="downloadTXT()">üíæ Download hasil (.txt)</button>

  <h3>Hasil:</h3>
  <pre id="output"></pre>

<script>
async function generateWithFallback(apiKeys, prompt) {
  for (const key of apiKeys) {
    try {
      const res = await fetch("https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=" + key, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          contents: [{ role: "user", parts: [{ text: prompt }] }]
        })
      });
      const data = await res.json();
      const text = data?.candidates?.[0]?.content?.parts?.[0]?.text || "";
      if (text.trim()) return text;
    } catch (err) {
      console.warn("‚ö†Ô∏è API gagal:", key, err);
    }
  }
  return "";
}

async function generateTitles() {
  const keywords = document.getElementById("keywords").value.split("\n").map(k => k.trim()).filter(Boolean);
  const apiKeys = document.getElementById("apiKeys").value.split("\n").map(k => k.trim()).filter(Boolean);
  const output = document.getElementById("output");
  const downloadBtn = document.getElementById("downloadBtn");

  if (!keywords.length || !apiKeys.length) {
    alert("Isi dulu keyword dan API key-nya ya, beb üíã");
    return;
  }

  output.textContent = "‚è≥ Sedang generate judul...";
  downloadBtn.style.display = "none";

  let allResults = [];

  for (const kw of keywords) {
    const prompt = `
Buatkan 100 variasi judul pendek dalam Bahasa Indonesia berdasarkan tema dracin berjudul "${kw}".
Judul harus tetap mengandung kata kunci utama dalam bahasa aslinya (${kw}), 
tapi bagian tambahan (prefix/suffix) dalam Bahasa Indonesia agar terasa natural, emosional, dan clickbait.
Contoh: "Rahasia di Balik Hidden Love", "Hidden Love: Cinta yang Tak Terungkap".

Format hasil: satu judul per baris, tanpa nomor urut atau simbol tambahan.
    `;
    output.textContent = `‚è≥ Sedang generate untuk '${kw}'...`;
    const result = await generateWithFallback(apiKeys, prompt);
    if (result.trim()) {
      allResults.push(result.trim());
      console.log(`‚úÖ Sukses: ${kw}`);
    } else {
      allResults.push(`‚ö†Ô∏è Gagal generate untuk '${kw}'`);
    }
  }

  const finalText = allResults.join("\n\n");
  output.textContent = finalText;
  downloadBtn.style.display = "inline-block";

  // simpan hasil global buat di-download
  window.finalResult = finalText;
}

function downloadTXT() {
  const blob = new Blob([window.finalResult || ""], { type: "text/plain" });
  const link = document.createElement("a");
  link.href = URL.createObjectURL(blob);
  link.download = "judul_dracin_bilingual.txt";
  link.click();
}
</script>
</body>
</html>
